---------------------------------------------------------
Trace Demux Frame Test - check CoreSight frame processing
---------------------------------------------------------

** Library Version : 1.8.0


---------------------------------------------------------
Demux Init Tests - check bad input rejected
---------------------------------------------------------
DFMT_CSFRAMES : 0x0006 (OCSD_ERR_INVALID_PARAM_VAL) [Invalid value parameter passed to component.]; No Config Flags Set
Check 0 flag error: PASS
DFMT_CSFRAMES : 0x0006 (OCSD_ERR_INVALID_PARAM_VAL) [Invalid value parameter passed to component.]; Unknown Config Flags
Check unknown flag error: PASS
DFMT_CSFRAMES : 0x0006 (OCSD_ERR_INVALID_PARAM_VAL) [Invalid value parameter passed to component.]; Invalid Config Flag Combination Set
Check bad combination flag error: PASS

---------------------------------------------------------
MemAligned Buffer tests: exercise the 16 byte frame buffer handler
---------------------------------------------------------

..Sub Test 1 : MemAlignFrame
Frame Data; Index      0;    RAW_PACKED; 21 01 02 03 04 05 06 07 41 08 08 0a 0a 0c 0c e0 
Frame Data; Index      0;   ID_DATA[0x10]; 01 02 03 04 05 06 07 
Frame Data; Index      8;   ID_DATA[0x20]; 08 09 0a 0b 0c 0d 
Frame Data; Index     16;    RAW_PACKED; 0e 0f 61 10 10 12 12 14 14 16 21 17 18 19 20 3c 
Frame Data; Index     16;   ID_DATA[0x20]; 0e 0f 
Frame Data; Index     18;   ID_DATA[0x30]; 10 11 12 13 14 15 16 17 
Frame Data; Index     26;   ID_DATA[0x10]; 18 19 20 

..Sub Test 2 : MemAlignFrame-8-ID
Frame Data; Index      0;    RAW_PACKED; 21 01 02 03 04 05 06 07 41 08 08 0a 0a 0c 0c e0 
Frame Data; Index      0;   ID_DATA[0x10]; 01 02 03 04 05 06 07 
Frame Data; Index      8;   ID_DATA[0x20]; 08 09 0a 0b 0c 0d 
Frame Data; Index     16;    RAW_PACKED; 03 0e 05 0f 07 10 09 11 0b 12 0d 13 0f 14 50 ff 
Frame Data; Index     16;   ID_DATA[0x20]; 0e 
Frame Data; Index     16;   ID_DATA[0x01]; 0f 
Frame Data; Index     18;   ID_DATA[0x02]; 10 
Frame Data; Index     20;   ID_DATA[0x03]; 11 
Frame Data; Index     22;   ID_DATA[0x04]; 12 
Frame Data; Index     24;   ID_DATA[0x05]; 13 
Frame Data; Index     26;   ID_DATA[0x06]; 14 
Frame Data; Index     28;   ID_DATA[0x07]; 51 
Frame Data; Index     32;    RAW_PACKED; 14 16 16 18 18 1a 1a 1c 41 1d 1e 1f 20 21 22 0f 
Frame Data; Index     32;   ID_DATA[0x07]; 15 16 17 18 19 1a 1b 1c 
Frame Data; Index     40;   ID_DATA[0x20]; 1d 1e 1f 20 21 22 

..Sub Test 3 : MemAlignFrame-rst_st
Frame Data; Index      0;         FSYNC; ff ff ff 7f ff ff ff 7f ff ff ff 7f ff ff ff 7f 
Frame Data; Index      0;    RAW_PACKED; ff ff ff 7f ff ff ff 7f ff ff ff 7f ff ff ff 7f 
21 01 02 03 04 05 06 07 41 08 08 0a 0a 0c 0c e0 
Frame Data; Index     16;   ID_DATA[0x10]; 01 02 03 04 05 06 07 
Frame Data; Index     24;   ID_DATA[0x20]; 08 09 0a 0b 0c 0d 
Frame Data; Index     32;    RAW_PACKED; 0e 0f 61 10 10 12 12 14 14 16 21 17 18 19 20 3c 
Frame Data; Index     32;   ID_DATA[0x20]; 0e 0f 
Frame Data; Index     34;   ID_DATA[0x30]; 10 11 12 13 14 15 16 17 
Frame Data; Index     42;   ID_DATA[0x10]; 18 19 20 

..Sub Test 4 : MemAlignFrame-rst_mid
Frame Data; Index      0;    RAW_PACKED; 21 01 02 03 04 05 06 07 41 08 08 0a 0a 0c 0c e0 
Frame Data; Index      0;   ID_DATA[0x10]; 01 02 03 04 05 06 07 
Frame Data; Index      8;   ID_DATA[0x20]; 08 09 0a 0b 0c 0d 
Frame Data; Index     16;         FSYNC; ff ff ff 7f ff ff ff 7f ff ff ff 7f ff ff ff 7f 
Frame Data; Index     16;    RAW_PACKED; ff ff ff 7f ff ff ff 7f ff ff ff 7f ff ff ff 7f 
0e 0f 61 10 10 12 12 14 14 16 21 17 18 19 20 3c 
Frame Data; Index     32;   ID_DATA[????]; 0e 0f 
Frame Data; Index     34;   ID_DATA[0x30]; 10 11 12 13 14 15 16 17 
Frame Data; Index     42;   ID_DATA[0x10]; 18 19 20 

..Sub Test 5 : MemAlignFrame-rst_en
Frame Data; Index      0;    RAW_PACKED; 21 01 02 03 04 05 06 07 41 08 08 0a 0a 0c 0c e0 
Frame Data; Index      0;   ID_DATA[0x10]; 01 02 03 04 05 06 07 
Frame Data; Index      8;   ID_DATA[0x20]; 08 09 0a 0b 0c 0d 
Frame Data; Index     16;    RAW_PACKED; 0e 0f 61 10 10 12 12 14 14 16 21 17 18 19 20 3c 
Frame Data; Index     16;   ID_DATA[0x20]; 0e 0f 
Frame Data; Index     18;   ID_DATA[0x30]; 10 11 12 13 14 15 16 17 
Frame Data; Index     26;   ID_DATA[0x10]; 18 19 20 
Frame Data; Index     32;         FSYNC; ff ff ff 7f ff ff ff 7f ff ff ff 7f ff ff ff 7f 
Frame Data; Index     32;    RAW_PACKED; ff ff ff 7f ff ff ff 7f ff ff ff 7f ff ff ff 7f 

TEST : PASS

---------------------------------------------------------
FSYNC & HSYNC tests: check hander code for TPIU captures works.
---------------------------------------------------------

..Sub Test 1 : HSyncFSync frame
Frame Data; Index      0;    RAW_PACKED; ff ff ff 7f 21 01 02 03 ff 7f 41 04 04 06 06 08 
ff 7f 08 0a 21 0b 0c 78 
Frame Data; Index      4;   ID_DATA[0x10]; 01 02 03 
Frame Data; Index      8;   ID_DATA[0x20]; 04 05 06 07 08 09 0a 0b 
Frame Data; Index     16;   ID_DATA[0x10]; 0c 

..Sub Test 2 : HSyncFSync split frame
Frame Data; Index      0;    RAW_PACKED; ff ff 
Frame Data; Index      2;    RAW_PACKED; ff 7f 21 01 02 03 ff 7f 41 04 04 06 06 08 ff 7f 
08 0a 21 0b 0c 78 
Frame Data; Index      4;   ID_DATA[0x10]; 01 02 03 
Frame Data; Index      8;   ID_DATA[0x20]; 04 05 06 07 08 09 0a 0b 
Frame Data; Index     16;   ID_DATA[0x10]; 0c 

..Sub Test 3 : HSyncFSync bad input data
DFMT_CSFRAMES : 0x0012 (OCSD_ERR_DFMTR_BAD_FHSYNC) [Bad frame or half frame sync in trace deformatter]; TrcIdx=2; Bad FSYNC start in frame or invalid ID (0x7F).
Test Datapath error response: OCSD_RESP_FATAL_INVALID_DATA: Processing Fatal Error :  invalid trace data.
Got correct error response for invalid input

TEST : PASS

---------------------------------------------------------
Demux Bad Data Test - arbitrary test data input
---------------------------------------------------------
Frame Data; Index      0;         FSYNC; ff ff ff 7f 
DFMT_CSFRAMES : 0x0012 (OCSD_ERR_DFMTR_BAD_FHSYNC) [Bad frame or half frame sync in trace deformatter]; TrcIdx=0; Incorrect FSYNC frame reset pattern
Test Datapath error response: OCSD_RESP_FATAL_INVALID_DATA: Processing Fatal Error :  invalid trace data.
Got correct error response for invalid input

TEST : PASS


---------------------------------------------------------
Trace Demux Testing Complete
PASSED ALL tests


---------------------------------------------------------
